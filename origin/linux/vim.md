---
title: vim
date: 2017-02-16 14:20:21
categories: linux
header-img:
tags: linux
---

### 基本操作

编辑空白文件test:

`vim test`

现在是普通模式，进入插入模式：按下i

现在可以编辑文本，按下esc退出插入模式，按下：进入命令模式

输入wq回车，保存并退出。

vim 和 vi的区别
vim可以理解成vi的高级版本，比vi多了很多功能。



### 普通模式下

#### 移动光标

| 按键   | 说明       |
| ---- | -------- |
| `h`  | 左        |
| `l`  | 右（小写L）   |
| `j`  | 下        |
| `k`  | 上        |
| `w`  | 移动到下一个单词 |
| `b`  | 移动到上一个单词 |

shift + h : 第一行行首  （同gg）

shift + l : 最后一行行首 ，当前屏幕  

shift+g： 最后一行行首

nG（n Shift+g）游标移动到第 n 行**(如果默认没有显示行号，请先进入命令模式，输入:set nu以显示行号)**

**小技巧：你在完成依次跳转后，可以使用Ctrl+o快速回到上一次(跳转前)光标所在位置**,这个技巧很实用



n+空格  移动n个空格
n+回车  移动n行
0 零 ，移动到这行的最前处，相当于home



ctrl + f (forth) 向下移动一页
ctrl + b(back) 向上移动一页



#### 行内跳转

上面是行间跳转，下面说下行内跳转。 

f +字母 ：向后搜索<字母>并跳转到第一个匹配的位置(非常实用)

`~`将游标所在字母变成大写或小写



#### 当前光标处进入插入模式：

| 命令   | 说明                   |
| ---- | -------------------- |
| `i`  | 在当前光标处进行编辑           |
| `I`  | 在行首插入                |
| `A`  | 在行末插入                |
| `a`  | 在光标后插入编辑             |
| `o`  | 在当前行后插入一个新行          |
| `O`  | 在当前行前插入一个新行          |
| `cw` | 替换从光标所在位置后到一个单词结尾的字符 |

#### 删除文本信息

普通模式：

| 命令       | 说明            |
| -------- | ------------- |
| `x`      | 删除游标所在的字符     |
| `X`      | 删除游标所在前一个字符   |
| `Delete` | 同`x`          |
| `dd`     | 删除整行          |
| `dw`     | 删除一个单词（不适用中文） |
| `d$`或`D` | 删除至行尾         |
| `d^`     | 删除至行首         |
| `dG`     | 删除到文档结尾处      |
| `d1G`    | 删至文档首部        |

2dd一次删除两行

8dd一次删除八行等等。。



#### 复制和粘贴文本

- 普通模式中使用`y`复制
  - 普通模式中，`yy`复制游标所在的整行（`3yy`表示复制3行）
  - 普通模式中，`y^` 复制至行首，或`y0`。不含光标所在处字符。
  - 普通模式中，`y$` 复制至行尾。含光标所在处字符。
  - 普通模式中，`yw` 复制一个单词。
  - 普通模式中，`y2w` 复制两个单词。
  - 普通模式中，`yG` 复制至文本末。
  - 普通模式中，`y1G` 复制至文本开头。
- 普通模式中使用`p`粘贴
  - 普通模式中，`p`(小写)代表粘贴至光标后（下）
  - 普通模式中，`P`(大写)代表粘贴至光标前（上）

剪贴和粘贴

其实前面讲得`dd`删除命令就是剪切，你每次`dd`删除文档内容后，便可以使用`p`来粘贴，也这一点可以让我们实现一个很爽快的功能——交换上下行：

`ddp`,就这么简单，即实现了快速交换光标所在行与它下面的行



#### 替换和撤销

| 命令      | 说明                    |
| ------- | --------------------- |
| r+待替换字母 | 游标所在字母换为制定字母          |
| R       | 连续替换，知道按下Esc          |
| cc      | 替换正行，即删除游标所在行，并进入插入模式 |
| cw      | 替换一个单词，删除一个单词，并进入插入模式 |
| C       | 替换游标以后至行末             |
| ~       | 反转游标所在字母大小写           |
| u+n     | 撤销一次或者n次操作，按u,只撤销一次   |
| U       | 侧小当前行的所有修改            |
| Ctrl+r  | undo的操作               |



#### 缩进

`>>`将整行将向右缩进，（用于格式化代码）

`<<` 整行想左回退

#### 调整文本位置

命令模式下输入：

`ce`(center)本行文本居中

`le`(le) 本行文本内容靠左

#### 查找

普通模式下输入/ 然后进入要查找的字符，向下查找

？ 向上查找

进入查找之后，输入n,表示继续查找，N反向查找。

高级查找：

- 普通模式下输入`\*`寻找游标所在处的单词
- 普通模式下输入`\#`同上，但 `\#` 是向前（上）找，`\*`则是向后（下）找
- 普通模式下输入`g\*`同`\*` ，但部分符合该单词即可
- 普通模式下输入`g\#`同`\#` ，但部分符合该单词即可

以上查找`n`,`N` 的继续查找命令依然可以用

### 命令模式

| 命令   | 说明                   |
| ---- | -------------------- |
| `i`  | 在当前光标处进行编辑           |
| `I`  | 在行首插入                |
| `A`  | 在行末插入                |
| `a`  | 在光标后插入编辑             |
| `o`  | 在当前行后插入一个新行          |
| `O`  | 在当前行前插入一个新行          |
| `cw` | 替换从光标所在位置后到一个单词结尾的字符 |





### 退出vim
* 普通模式退出vim

`shift+zz `  并不保存



* 命令模式退出vim

：q! 强制退出，不保存

：wq! 强制退出，保存

：saveas 文件路径   另存为

：w <文件路径> 另存为

：x或者wq  保存并退出



### 多文件编辑

同时创建两个新文件并编辑

```
$ vim 1.txt 2.txt

```

默认进入`1.txt`文件的编辑界面

- 命令行模式下输入`:n`编辑2.txt文件，可以加`!`即`:n!`强制切换，之前一个文件的输入没有保存，仅仅切换到另一个文件
- 命令行模式下输入`:N`编辑1.txt文件，可以加`!`即`:N!`强制切换，之前文件内的输入没有保存，仅仅是切换到另一个文件



#### 进入vim后打开新文件

- 命令行模式下输入`:e 3.txt` 打开新文件3.txt
- 命令行模式下输入`:e#` 回到前一个文件
- 命令行模式下输入`:ls`可以列出以前编辑过的文档
- 命令行模式下输入`:b 2.txt`（或者编号）可以直接进入文件2.txt编辑
- 命令行模式下输入`:bd 2.txt`（或者编号）可以删除以前编辑过的列表中的文件项目
- 命令行模式下输入`:e! 4.txt`，新打开文件4.txt，放弃正在编辑的文件
- 命令行模式下输入`:f` 显示正在编辑的文件名
- 命令行模式下输入`:f new.txt`，改变正在编辑的文件名字为new.txt



### 视图操作

- 普通模式下`Ctrl-w s` 将当前窗口分割成两个水平的窗口
- 普通模式下`Ctrl-w v` 将当前窗口分割成两个垂直的窗口
- 普通模式下`Ctrl-w q` 即 :q 结束分割出来的视窗。如果在新视窗中有输入需要使用强制符！即:q!
- 普通模式下`Ctrl-w o` 打开一个视窗并且隐藏之前的所有视窗
- 普通模式下`Ctrl-w j` 移至下面视窗
- 普通模式下`Ctrl-w k` 移至上面视窗
- 普通模式下`Ctrl-w h` 移至左边视窗
- 普通模式下`Ctrl-w l` 移至右边视窗
- 普通模式下`Ctrl-w J` 将当前视窗移至下面
- 普通模式下`Ctrl-w K` 将当前视窗移至上面
- 普通模式下`Ctrl-w H` 将当前视窗移至左边
- 普通模式下`Ctrl-w L` 将当前视窗移至右边
- 普通模式下`Ctrl-w -` 减小视窗的高度
- 普通模式下`Ctrl-w +` 增加视窗的高度




#### 多窗口

:sp [filename] 如果有文件名则显示这个文件名，如果没有就多窗口显示本文件，横向切割
:vsp [filename] 同上，纵向切割
:only 只保留当前窗口，其他去掉
ctrl + w + 方向键 窗口切换
ctrl + w + q 结束当前窗口，或者可以用命令结束：q




### 在vim中执行外部命令

在命令行模式中输入`!`可以执行外部的shell命令

- `:!ls` 用于显示当前目录的内容
- `:!rm FILENAME`用于删除名为 FILENAME 的文件
- `:w FILENAME`可将当前 VIM 中正在编辑的文件另存为 FILENAME 文件




### 文件加密

`vim -x file1`

输入密码，确认密码

下次打开，vim会要求你输入密码。



### 恢复文件

如果因为断电等原因造成文档没有保存，可以采用恢复方式，`vim -r`进入文档后，输入`:ewcover 1.txt`来恢复

```
$ vim -r 1.txt
```


### 其他

#### 多行注释

普通模式下（命令模式），ctrl+v 进入到选择模式， 然后移动光标选择要注释的多行，大写I，输入注释符号（eg:c的//），再**按两下**ESC即可实现多行注释。

#### 撤销

u 撤销 和 ctrl + r 先前撤销

#### 断行

断行
linux系统仅有LF的断行
DOS(windows)系统有CRLF断行

文件在两种系统下的转换
dos2UNIX -kn file newfile 
UNIX@dos -kn file newfile
k: 保留时间格式
n: 保存源文件，将格式变换后的新文件输出。

#### 4空格替换tab

在配置文件/etc/vim/vimrc中：

```
set ts=4
set expandtab
```

ts = tabstop。 

重启vim可让配置生效

如果是已经保存的文件：

```
:set ts=4
:set expandtab
:%retab!
```